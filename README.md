# SketchyCode

SketchyCode is a tool to generate code from Sketch files. It is currently very experimental, but is showing the signs of being useful. I am
looking for ideas and contributions! This tool is incomplete, and this README is largely to see if there is interest in taking the idea further.

## But Why?

There are a few practical uses for generating code from Sketch, like synchronizing text styles and color paletes. There are also a few
experimental ideas, like generating UIView subclasses, and replacing Interface Builder. The last two are probably terrible ideas, but
fun they are fun to explore.

# Does it work?
As a PoC, here is a template that will generate a [BonMot](https://github.com/Raizlabs/BonMot) `TextStyle` enumeration with the color
and font of all of the text styles defined.

```
enum TextStyle {
{% for style in document.layerTextStyles.objects %}
    static var {{ style.name.variabled }}: StringStyle {
        var style = StringStyle()
{% if style.value.textStyle.color %}
        style.color = {{ style.value.textStyle.color|colorLiteral }}
{% endif %}
{% if style.value.textStyle.font %}
        style.font =  UIFont(name: "{{ style.value.textStyle.font.fontName }}", size: {{ style.value.textStyle.font.pointSize }})
{% endif %}
        return style
    }
{% endfor %}
}
```
This is not a complete style definition yet, but it appears that all of the data is importing is working, it's just template work left.

# Sketch File Format

The Sketch file format is [open](https://medium.com/sketch-app-sources/sketch-43-is-coming-to-town-with-a-new-game-an-open-file-format-ae62e7e7c223)
and exportable to JSON via [Sketch Tool](https://www.sketchapp.com/tool/). While the file format is not stable or highly documented, the
JSON is semi-self describing and contains a key `<class>` with the class name of the JSON blobs as they are exported.

In an attempt to establish a maintainable position, SketchyCode will use this information to parse any given Sketch file and generate Swift code that can
import the Sketch Tool JSON output into a collection of Swift objects. These Swift Objects, along with some custom-extensions on those objects are then passed to a
[Stencil](https://github.com/kylef/Stencil) template to generate code.

However, the object model is only as good as the input document. For example, any unused features in the input Sketch document will result in missing
keys and values in the JSON, which in turn results in missing import code.

To see the generated Swift code that can import a Sketch file, check out [SketchClasses.swift](SketchyCode/SketchClasses.swift). The input document
wasn't using all the features however and there is missing import code. This code is generated by [SketchTypeBuilder.swift](SketchyCode/JSONBuilder/SketchTypeBuilder.swift).

You can generate classes from your sketch file by modifying the `SketchyCode (Model Generation)` Scheme run arguments to point to your file or on the command line with:

```sh
sketchycode --generate-classes --file MyFile.sketch
```

A real, production ready strategy here is to request an official API dump from Sketch Tool (Know anyone?). However, a servicable
strategy is possible if I can get a document that excercises all of the major features in Sketch. With this, a proper versioned API can be
generated and maintained.

# Contributing

If you are interested in Contributing, please reach out!

# Shout Out

A huge shout out to [SwiftGen](https://github.com/SwiftGen/SwiftGen) and [Sourcery](https://github.com/krzysztofzablocki/Sourcery) and
[Stencil](https://github.com/kylef/Stencil). This turned out to be a few day project because I was able to steal massive amounts of code. Thanks!

## But why not a Sketch Plugin?
This is a [viable approach](https://github.com/Charimon/iosViews) as well. However it would be in javascript, and would require running Sketch
and (I believe) UI interaction to manage.

# Why not SwiftGen
I was originally planning on a PR to [SwiftGen](https://github.com/SwiftGen/SwiftGen), but this feels to be more experimental than the intent of
SwiftGen. It would be great to stabilize features here and port them over. I also am interested in incorporating the FileWatcher behavior from
Sourcery to monitor the Sketch file and regenerate code when it changes.
